# n8n Workflow Evaluation: jina-ai風scraping

提供されたワークフロー「jina-ai風scraping」を解析・評価しました。

## 1. 評価レポート

| 評価項目 | スコア | 備考 |
| :--- | :---: | :--- |
| **構造の明確さ** | 4.0 | シンプルな1本道で分かりやすいが、入出力が不明確。 |
| **保守性** | 2.5 | ノード名がデフォルトのままで、URLがハードコードされている。 |
| **拡張性** | 2.0 | 他のURLへの切り替えや一括処理に対応しにくい設計。 |
| **再利用性** | 2.0 | 特定の環境（localhost）に依存しており、汎用性が低い。 |
| **エラー耐性** | 1.0 | エラーハンドリング（リトライ、分岐、通知）が一切ない。 |

### 総合判定
**平均点: 2.3 / 5.0**  
**判定: ❌ 要改善（不合格）**

---

## 2. 改善点一覧

1. **ハードコードの排除**: HTTP RequestのURLが直接書き込まれています。外部から引数として受け取る設計にすべきです。
2. **命名の具体化**: 「HTTP Request」「Basic LLM Chain」などのデフォルト名は、後から見返した際に役割が不明確です。
3. **エラーハンドリングの欠如**: スクレイピング対象のサイトが落ちている場合や、LLMのAPIエラー時にワークフローが停止してしまいます。
4. **出力構造の整理**: LLMに「本文」「要約」「見出し案」の3つを求めていますが、最終的な出力（Edit Fields）では1つのフィールドにまとめようとしており、情報が混ざる可能性があります。
5. **環境依存**: `host.docker.internal` はローカル開発環境特有の設定であり、共有やクラウド移行時に修正が必要です。

---

## 3. 改善後のワークフロー設計書

### 構成案
1. **Trigger**: `Manual Trigger` または `Execute Workflow`
   - 入力変数として `target_url` を定義
2. **HTTP Request**: (名称: `Fetch Web Page via Jina-Reader`)
   - URLを `{{ $json.target_url }}` に変更
   - エラー設定: `Continue On Fail` または `Retry` を有効化
3. **Code Node**: (名称: `Clean HTML Noise`)
   - 既存のクレンジング処理を継続（トークン節約に有効）
4. **AI Agent / LLM Chain**: (名称: `Extract Article Components`)
   - **Structured Output** を使用し、「本文」「要約」「見出し」を配列/オブジェクトとして取得
5. **Error Handler**:
   - `Error Trigger` を追加し、Slack/Discord等に通知するフローを並列化

---

## 4. Todoリスト

- [ ] HTTP Request内のURL（`https://note.com/...`）を変数化する
- [ ] すべてのノード名を役割がわかる名称に変更する
- [ ] HTTP Requestノードの「On Error」設定でリトライ（3回程度）を追加する
- [ ] LLMのプロンプトを整理し、JSON形式で結果を返却させるよう調整する
- [ ] 最終的な `Edit Fields` ノードで「本文」「要約」「見出し案」を個別のフィールドに展開する
- [ ] (オプション) 処理失敗時に通知を送る `Error Trigger` フローを作成する
